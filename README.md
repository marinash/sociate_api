#Sociate.ru Api 

##Общие положения:

 - текущая версия API располагается по адресу [https://sociate.ru/api/v1.0/](http://sociate.ru/api/v1.0/)
 - метод запроса (GET или POST) не имеет значения.
 - в результате вызова возвращается JSON.
 - для защищенных методов (указано в описании метода) требуется access_token, как его получить см. ниже

**Получение access_token:**
 - зарегистрируйтесь на http://sociate.ru (например, через VK)
 - пришлите ваш email, на который вы подтвердили аккаунт на  [support@sociate.ru](mailto:support@sociate.ru)
 - мы сгенерируем токен и он будет доступен в вашем профиле - http://sociate.ru/user/profile/

На данный момент все токены "вечные", но могут быть отозваны администрацией.

В случае удачного выполнения запроса результат выглядит следующим образом:
```
{'response': ... }
```
В `response` содержится результат вызова.

В случае ошибки при запросе результат выглядит следующим образом:
```
{'error': {'error_code': 1, 'error_msg': 'some msg', 'request_params': [{'key': 'foo', 'value': 'bar'}]}}
```

Коды ошибок:
 - -1 (минус один) - внутренняя ошибка
 - 10 - ошибочный запрос
 - 20 - токен некорректен
 - 30 - аргументы метода некорректны
 - 40 - результат вызова не определен, повторите запрос через несколько минут.
 - 50 - объект не найден.

##autopost.canPost 
Метод требует корректного access_token при вызове.

Метод позволяет узнать можно ли размещать отложенную запись в зависимости 
от того есть ли на указанное время рекламный пост на первом месте.

```
https://sociate.ru/api/v1.0/?method=autopost.canPost&gid=123123&date=2013-01-01&time=18:00&access_token=some_token
```

параметры:

`method` - autopost.canPost (с учетом регистра)

`gid` - положительное число, идентификатор группы или паблика ВКонтакте.

`date` - дата постинга в формате `YYYY-MM-DD`, пример - `2013-01-01`

`time` - время постинга в формате `HH:MM`, пример - `18:00`

`timestamp` - время постинга в формате unixtimestamp, пример - `1372860000`

Требуется указать date и time или timestamp

`date_format` - опциональный параметр, формат для возвращаемого времени, допустимые значения: 'datetime' и 'timestamp'. Формат по-умолчанию - datetime.

`test` - флаг для вызова заглушки, допустимые значения: 'ok' и 'fail', указывает вернуть разрешающий или запрещающий ответ.

результат вызова - объект. поле `allowed` присутствует всегда и указывает, можно размещать пост или нет. 

- размещать отложенный пост можно:

```
{'response': {'allowed': 1}}
``` 

 - размещать отложенный пост нельзя, время занято рекламой
 - поле `timestamp` содержит время в формате unixtime, до которого рекламный пост будет на первом месте. Присутствует, только если при запросе был указан соответствующий формат
 - поле `date` содержит дату, до которой рекламный пост будет на первом месте
 - поле `time` содержит время, до которого рекламный пост будет на первом месте:

```
{'response': {'allowed': 0, 'date': '2013-01-01', 'time': '18:00'}}
``` 

```
{'response': {'allowed': 0, 'timestamp': '1372860000'}}
``` 

##search.get 
Метод требует корректного access_token при вызове.

Метод позволяет получить активированные площадки сервиса. 

```
https://sociate.ru/api/v1.0/?method=search.get&provider=vkontakte&offset=1000&limit=1000&access_token=some_token
```

параметры:

`method` - search.get (с учетом регистра)

`provider` - одно из двух значений - `vkontakte` или `odnoklassniki`, по-умолчанию `vkontakte`

`limit` - количество площадок в ответе. не более 1000. значение по-умолчанию - 1000.

`offset` - смещение относительно начала списка. по-умолчанию 0.

Результат вызова - список объектов. Пример объекта:
```
{
 'id': 123, 
 'provider': 'vkontakte', 
 'provider_name': 'ВКонтакте', 
 'price': 1150
}
```
